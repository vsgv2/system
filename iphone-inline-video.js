/*
 npm.im/iphone-inline-video 2.0.2  npm.im/intervalometer */
var enableInlineVideo=function(){function p(a,c,b,q){function e(b){g=c(e,q);a(b-(d||b));d=b}var g,d;return{start:function(){g||e(0)},stop:function(){b(g);g=null;d=0}}}function h(a,c,b,d){function e(c){!!a[b]===!!d&&c.stopImmediatePropagation();delete a[b]}a.addEventListener(c,e,!1);return e}function d(a,c,b,d){function e(a){b[c]=a}d&&e(a[c]);Object.defineProperty(a,c,{get:function(){return b[c]},set:e})}function l(a,c,b){b.addEventListener(c,function(){return a.dispatchEvent(new Event(c))})}function f(a,
c){Promise.resolve().then(function(){a.dispatchEvent(new Event(c))})}function r(a){var c=new Audio;l(a,"play",c);l(a,"playing",c);l(a,"pause",c);c.crossOrigin=a.crossOrigin;void 0!=a.childNodes[0]&&(c.src=a.childNodes[0].src||a.currentSrc||"data:");return c}function k(a,c,b){(m||0)+200<Date.now()&&(a["bfred-it:iphone-inline-video:event"]=!0,m=Date.now());b||(a.currentTime=c);n[++t%3]=100*c|0}function u(a){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=
this.video.currentTime+a*this.video.playbackRate/1E3,this.video.loop&&this.driver.currentTime>=this.video.duration&&(this.driver.currentTime=0)),k(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video["bfred-it:iphone-inline-video:event"],this.video.pause(!0))}function v(){var a=this["bfred-it:iphone-inline-video"];if(this.webkitDisplayingFullscreen)this["bfred-it:iphone-inline-video:nativeplay"]();
else"data:"!==a.driver.src&&0===this.buffered.length&&(k(this,0,!0),a.driver.src=this.childNodes[0].src),this.paused&&(a.paused=!1,0===this.buffered.length&&this.load(),a.driver.play(),a.updater.start(),a.hasAudio||(f(this,"play"),a.video.readyState>=a.video.HAVE_ENOUGH_DATA&&f(this,"playing")))}function w(a){var c=this["bfred-it:iphone-inline-video"];c.driver.pause();c.updater.stop();if(this.webkitDisplayingFullscreen)this["bfred-it:iphone-inline-video:nativepause"]();if(!c.paused||a)c.paused=!0,
c.hasAudio||f(this,"pause"),this.ended&&(this["bfred-it:iphone-inline-video:event"]=!0,f(this,"ended"))}function x(a,c){var b=a["bfred-it:iphone-inline-video"]={};b.paused=!0;b.hasAudio=c;b.video=a;b.updater=p(u.bind(b),requestAnimationFrame,cancelAnimationFrame);c?b.driver=r(a):(a.addEventListener("canplay",function(){a.paused||f(a,"playing")}),b.driver={src:a.childNodes[0].src||a.currentSrc||"data:",muted:!0,paused:!0,pause:function(){b.driver.paused=!0},play:function(){b.driver.paused=!1;b.driver.currentTime>=
b.video.duration&&k(a,0)},get ended(){return b.driver.currentTime>=b.video.duration}});a.addEventListener("emptied",function(){var c=!b.driver.src||"data:"===b.driver.src;b.driver.src&&b.driver.src!==a.childNodes[0].src&&(k(a,0,!0),b.driver.src=a.childNodes[0].src,c?b.driver.play():b.updater.stop())},!1);a.addEventListener("webkitbeginfullscreen",function(){a.paused?c&&0===b.driver.buffered.length&&b.driver.load():(a.pause(),a["bfred-it:iphone-inline-video:nativeplay"]())});c&&(a.addEventListener("webkitendfullscreen",
function(){b.driver.currentTime=a.currentTime}),a.addEventListener("seeking",function(){0>n.indexOf(100*a.currentTime|0)&&(b.driver.currentTime=a.currentTime)}))}var y="object"===typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,n=[],t=0,m;return function(a,c){void 0===c&&(c={});if(!a["bfred-it:iphone-inline-video"]&&(c.everywhere||y&&(c.iPad||c.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))){!a.paused&&a.webkitDisplayingFullscreen&&
a.pause();x(a,!a.muted);var b=a["bfred-it:iphone-inline-video"];a["bfred-it:iphone-inline-video:nativeplay"]=a.play;a["bfred-it:iphone-inline-video:nativepause"]=a.pause;a.play=v;a.pause=w;d(a,"paused",b.driver);d(a,"muted",b.driver,!0);d(a,"playbackRate",b.driver,!0);d(a,"ended",b.driver);d(a,"loop",b.driver,!0);h(a,"seeking");h(a,"seeked");h(a,"timeupdate","bfred-it:iphone-inline-video:event",!1);h(a,"ended","bfred-it:iphone-inline-video:event",!1);a.classList.add("IIV");a.muted&&a.autoplay&&a.play();
/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}}();